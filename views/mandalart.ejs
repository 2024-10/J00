<!DOCTYPE html>
<html>
<head>
  <title><%= title %></title>
</head>
<body>
  <h1>Mandalart</h1>
  <h2>Center Goal: <%= mandalart.centerGoal %></h2>
  <div id="mandalart-grid">
    <% if (tedolists.length > 0) { %>
      <% tedolists.forEach((tedolist, index) => { %>
        <div class="mandalart-cell">
          <h3>Task <%= index + 1 %>: <%= tedolist.tedolist_detail %></h3>
          <% if (checklists[tedolist.tedolist_number]) { %>
            <ul>
              <% checklists[tedolist.tedolist_number].forEach(checklist => { %>
                <li><%= checklist.checklist_detail %></li>
              <% }); %>
            </ul>
          <% } %>
          <form action="/mandalart/addChecklist" method="POST">
            <input type="hidden" name="tedolistNumber" value="<%= tedolist.tedolist_number %>">
            <input type="hidden" name="mandalart_id" value="<%= mandalart.mandalart_id %>">
            <label for="checklist">Add Checklist:</label>
            <input type="text" name="checklistDetail" id="checklist">
            <button type="submit">Add</button>
          </form>
        </div>
      <% }); %>
    <% } else { %>
      <form action="/mandalart/addTedolist" method="POST">
        <input type="hidden" name="mandalartId" value="<%= mandalart.mandalart_id %>">
        <label for="tedolistDetails">Enter your tasks (one per line):</label><br>
        <textarea name="tedolistDetails" id="tedolistDetails" rows="<%= mandalart.tedolist_count %>"></textarea>
        <button type="submit">Add Tasks</button>
      </form>
    <% } %>
  </div>
</body>
</html>
